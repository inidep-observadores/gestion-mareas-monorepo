generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          String   @id @default(uuid()) @db.Uuid
  email       String   @unique
  password    String
  fullName    String
  isActive    Boolean  @default(true)
  roles       String[] @default(["asistente_administrativo"])
  themePreference String @default("system")
  avatarUrl       String?
  
  products    Product[]
  resetTokens PasswordResetToken[]

  @@map("users")
}

model PasswordResetToken {
  id           String   @id @default(uuid()) @db.Uuid
  token        String
  expiresAt    DateTime @map("expires_at") @db.Timestamptz
  used         Boolean  @default(false)
  requestedIp  String?  @map("requested_ip")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz
  
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId       String   @map("user_id") @db.Uuid

  @@map("password_reset_tokens")
}

model Product {
  id          String   @id @default(uuid()) @db.Uuid
  title       String   @unique
  price       Float    @default(0)
  description String?
  slug        String   @unique
  stock       Int      @default(0)
  sizes       String[]
  gender      String
  tags        String[] @default([])
  
  images      ProductImage[]
  user        User     @relation(fields: [userId], references: [id])
  userId      String   @db.Uuid

  @@map("products")
}

model ProductImage {
  id        Int      @id @default(autoincrement())
  url       String
  
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  productId String   @db.Uuid

  @@map("product_images")
}
